# GitHub Actions –¥–ª—è Tasks10

## üéØ –û–±–∑–æ—Ä

–î–∞–Ω–Ω–∞—è –ø–∞–ø–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç CI/CD pipeline –¥–ª—è Tasks10 ML API —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π Prometheus –º–µ—Ç—Ä–∏–∫ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
.github/
‚îú‚îÄ‚îÄ workflows/
‚îÇ   ‚îú‚îÄ‚îÄ ci-cd.yml      # –û—Å–Ω–æ–≤–Ω–æ–π CI/CD pipeline
‚îÇ   ‚îî‚îÄ‚îÄ security.yml   # –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md          # –î–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üîÑ Workflow: ci-cd.yml

### –¢—Ä–∏–≥–≥–µ—Ä—ã
- **Push**: `main`, `develop` –≤–µ—Ç–∫–∏ (—Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ `Tasks10/`)
- **Pull Request**: –≤ `main` –≤–µ—Ç–∫—É (—Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ `Tasks10/`)
- **Manual**: —á–µ—Ä–µ–∑ GitHub UI (`workflow_dispatch`)

### –≠—Ç–∞–ø—ã

1. **Test** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ Python 3.11, 3.12, 3.13
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
   - Unit —Ç–µ—Å—Ç—ã —Å coverage
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API endpoints
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ Prometheus –º–µ—Ç—Ä–∏–∫

2. **Lint** - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞
   - Black (—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
   - isort (–∏–º–ø–æ—Ä—Ç—ã)
   - flake8 (–ª–∏–Ω—Ç–∏–Ω–≥)
   - mypy (—Ç–∏–ø–∏–∑–∞—Ü–∏—è)

3. **Docker Test** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
   - –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞
   - –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ endpoints (`/health`, `/metrics`, `/predict`)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è ML –º–µ—Ç—Ä–∏–∫

4. **Build and Push** - –ü—É–±–ª–∏–∫–∞—Ü–∏—è –æ–±—Ä–∞–∑–∞ (—Ç–æ–ª—å–∫–æ `main`)
   - –õ–æ–≥–∏–Ω –≤ GitHub Container Registry
   - –°–±–æ—Ä–∫–∞ –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—è –æ–±—Ä–∞–∑–∞
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è deployment –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤

5. **Notify** - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ

### –û–±—Ä–∞–∑ –≤ —Ä–µ–µ—Å—Ç—Ä–µ
```
ghcr.io/darveter24/mlopstraining/tasks10-ml-service-api:latest
```

## üîí Workflow: security.yml

### –¢—Ä–∏–≥–≥–µ—Ä—ã
- **Push/PR**: –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –≤ `Tasks10/`
- **Schedule**: –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ –ø–æ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞–º –≤ 02:00 UTC

### –ü—Ä–æ–≤–µ—Ä–∫–∏
- **Safety**: —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
- **Bandit**: –∞–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Python –∫–æ–¥–∞
- **Trivy**: —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ Docker –æ–±—Ä–∞–∑–∞
- **CodeQL**: —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞

## üöÄ Path Filters

–í–∞–∂–Ω–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å: –≤—Å–µ workflow'—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç **path filters**:

```yaml
on:
  push:
    paths: 
      - 'Tasks10/**'  # –¢–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Tasks10/
```

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:
- ‚úÖ Tasks10 workflows –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –≤ `Tasks10/`
- ‚úÖ Tasks9 workflows –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –≤ `Tasks9/`
- ‚úÖ –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –º–µ–∂–¥—É –ø—Ä–æ–µ–∫—Ç–∞–º–∏
- ‚úÖ –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ GitHub Actions

## üìä –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ArgoCD

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞:

1. **Docker –æ–±—Ä–∞–∑** –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –≤ GHCR
2. **ArgoCD** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏—Ç –Ω–æ–≤—ã–π –æ–±—Ä–∞–∑
3. **Kubernetes** —Ä–∞–∑–≤–µ—Ä–Ω–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å
4. **Prometheus** –Ω–∞—á–Ω–µ—Ç —Å–æ–±–∏—Ä–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ —Å endpoint `/metrics`

## üß™ –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–µ—Ä–µ–¥ push'–æ–º –º–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ:

```bash
# –í –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ Tasks10/
make docker-build
make docker-run
curl http://localhost:8000/metrics
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `GITHUB_TOKEN` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è GitHub
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ Settings ‚Üí Secrets

### Permissions
Workflow –∏–º–µ–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è:
- `contents: read` - —á—Ç–µ–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- `packages: write` - –ø—É–±–ª–∏–∫–∞—Ü–∏—è –≤ GHCR
